{
  "_exportDate": "2019-06-11T13:46:08.438Z",
  "_type": "flow",
  "applicationId": "5cf96318afabc800087c6161",
  "customNodeVersions": [
  ],
  "customNodes": [
  ],
  "description": "Starter workflow for building a response to this endpoint",
  "enabled": true,
  "flowClass": "experience",
  "globals": [
  ],
  "id": "5cfa960868273600080365cc",
  "name": "Endpoint - POST /register",
  "nodes": [
    {
      "config": {
        "bodyTemplate": "/register/{{working.device.id}}",
        "bodyTemplateType": "string",
        "cookieInfo": [
        ],
        "headerInfo": [
        ],
        "replyIdPath": "",
        "replyType": "redirect",
        "responseCodeTemplate": "302"
      },
      "id": "SyLfJn-hx",
      "meta": {
        "category": "output",
        "description": "",
        "label": "Endpoint Reply",
        "name": "endpoint-reply",
        "x": 280,
        "y": 540
      },
      "outputIds": [
      ],
      "type": "EndpointReplyNode"
    },
    {
      "config": {
        "findMethod": "findByAllTags",
        "findMultiple": false,
        "includeState": false,
        "resultPath": "working.device",
        "resultsPage": "0",
        "resultsPerPage": "100",
        "sortDirection": "asc",
        "sortField": "name",
        "tags": [
          {
            "keyTemplate": "serial",
            "valueTemplate": "{{data.body.serial}}"
          }
        ],
        "tagsAsObject": true
      },
      "id": "W73xaT8iqb",
      "meta": {
        "category": "data",
        "description": "",
        "id": "W73xaT8iqb",
        "label": "Device: Get",
        "name": "get-device",
        "x": 180,
        "y": 180
      },
      "outputIds": [
        [
          "Ev7X49yNBq"
        ]
      ],
      "type": "GetDeviceNode"
    },
    {
      "config": {
        "expression": "{{working.device}} !== null"
      },
      "id": "Ev7X49yNBq",
      "meta": {
        "category": "logic",
        "description": "",
        "id": "Ev7X49yNBq",
        "label": "Conditional",
        "name": "conditional",
        "x": 180,
        "y": 280
      },
      "outputIds": [
        [
          "xm4ZnIKfnT"
        ],
        [
          "Lc3Bi5Kifk"
        ]
      ],
      "type": "ConditionalNode"
    },
    {
      "config": {
        "bodyTemplate": "/register?invalid=true",
        "bodyTemplateType": "string",
        "cookieInfo": [
        ],
        "headerInfo": [
        ],
        "replyIdPath": "",
        "replyType": "redirect",
        "responseCodeTemplate": "302"
      },
      "id": "xm4ZnIKfnT",
      "meta": {
        "category": "output",
        "description": "",
        "label": "Endpoint Reply",
        "name": "endpoint-reply",
        "x": 80,
        "y": 440
      },
      "outputIds": [
        [
          "m32TUk3nZI"
        ]
      ],
      "type": "EndpointReplyNode"
    },
    {
      "config": {
        "message": "",
        "property": ""
      },
      "id": "m32TUk3nZI",
      "meta": {
        "category": "output",
        "description": "",
        "label": "Debug",
        "name": "debug",
        "x": 80,
        "y": 540
      },
      "outputIds": [
      ],
      "type": "DebugNode"
    },
    {
      "config": {
        "dataMethod": "individualFields",
        "descriptionTemplate": "",
        "deviceAttributes": [
        ],
        "deviceClassTemplate": "",
        "deviceTags": [
          {
            "keyTemplate": "registerStartTime",
            "valueTemplate": "{{currentDateTime 'X'}}"
          },
          {
            "keyTemplate": "registerUserId",
            "valueTemplate": "{{experience.user.id}}"
          }
        ],
        "gatewayIdTemplate": "",
        "idTemplate": "{{working.device.id}}",
        "nameTemplate": "",
        "resultPath": "",
        "tagsAsObject": false
      },
      "id": "Lc3Bi5Kifk",
      "meta": {
        "category": "data",
        "description": "",
        "id": "Lc3Bi5Kifk",
        "label": "Device: Update",
        "name": "update-device",
        "x": 280,
        "y": 440
      },
      "outputIds": [
        [
          "SyLfJn-hx"
        ]
      ],
      "type": "UpdateDeviceNode"
    },
    {
      "config": {
      },
      "id": "CLF1M2nbei",
      "meta": {
        "annotationText": "TODO:\n1. Verify device is not already in a group.",
        "category": "annotation",
        "height": 220,
        "label": "Note",
        "name": "note",
        "width": 260,
        "x": 380,
        "y": 80
      },
      "outputIds": [
      ],
      "type": "AnnotationNode"
    }
  ],
  "triggers": [
    {
      "config": {
      },
      "key": "5cfa95ea66b3b30008490a36",
      "meta": {
        "category": "trigger",
        "description": "",
        "label": "Endpoint",
        "name": "endpoint",
        "uiId": "H1hL0oZhl",
        "x": 180,
        "y": 80
      },
      "outputIds": [
        [
          "W73xaT8iqb"
        ]
      ],
      "type": "endpoint"
    }
  ]
}